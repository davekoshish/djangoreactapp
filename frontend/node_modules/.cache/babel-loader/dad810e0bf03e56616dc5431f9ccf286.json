{"ast":null,"code":"import { API } from \"../../Backend\";\nimport { cartEmpty } from \"../../core/helper/Carthelper\";\n//cause after sign out i want cart to became empty\n\nexport var signup = function signup(user) {\n  return fetch(\"\".concat(API, \"user/\"), {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(user)\n  }).then(function (response) {\n    return response.json();\n  }).catch(function (err) {\n    return console.log(err);\n  });\n};\nexport var signin = function signin(user) {\n  var formData = new FormData();\n  for (var name in user) {\n    formData.append(name, user[name]);\n  }\n  return fetch(\"\".concat(API, \"user/login/\"), {\n    method: \"POST\",\n    body: formData\n  }).then(function (response) {\n    console.log(\"SUCESS\", response);\n    return response.json();\n  }).catch(function (err) {\n    return console.log(err);\n  });\n};\nexport var authenticate = function authenticate(data, next) {\n  if (typeof window !== undefined) {\n    localStorage.setItem(\"jwt\", JSON.stringify(data));\n    next();\n  }\n};\nexport var iisAuthenticated = function iisAuthenticated() {\n  if (typeof window == undefined) {\n    return false;\n  }\n  if (localStorage.getItem(\"jwt\")) {\n    return JSON.parse(localStorage.getItem(\"jwt\"));\n  } else {\n    return false;\n  }\n};\nexport var signout = function signout(next) {\n  var userId = iisAuthenticated() && iisAuthenticated().user.userId;\n  if (typeof window !== undefined) {\n    localStorage.removeItem(\"jwt\");\n    cartEmpty(function () {});\n    //next();\n\n    return fetch(\"\".concat(API, \"user/logout/\").concat(userId), {\n      method: \"GET\"\n    }).then(function (response) {\n      console.log(\"signout success\");\n      next();\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  }\n};","map":{"version":3,"names":["API","cartEmpty","signup","user","fetch","method","headers","Accept","body","JSON","stringify","then","response","json","catch","err","console","log","signin","formData","FormData","name","append","authenticate","data","next","window","undefined","localStorage","setItem","iisAuthenticated","getItem","parse","signout","userId","removeItem"],"sources":["C:/Users/davek/Desktop/Study/Project/django/koshidj/frontend/src/auth/helper/index.js"],"sourcesContent":["import {API} from \"../../Backend\";\r\nimport { cartEmpty } from \"../../core/helper/Carthelper\";\r\n//cause after sign out i want cart to became empty\r\n\r\n\r\nexport const signup = (user) =>\r\n{\r\n    return fetch(`${API}user/`,{\r\n        method:\"POST\",\r\n        headers:{\r\n            Accept: \"application/json\",\r\n            \"Content-Type\":\"application/json\"\r\n        },\r\n        body: JSON.stringify(user)\r\n    })\r\n    .then(response=>{\r\n        return response.json();\r\n    })\r\n    .catch(err=>console.log(err))\r\n};\r\n\r\nexport const signin = (user) =>\r\n{\r\n    const formData = new FormData()\r\n\r\n    for (const name in user)\r\n    {\r\n        formData.append(name,user[name]) \r\n    }\r\n\r\n    return fetch(`${API}user/login/`,{\r\n        method:\"POST\",\r\n        body:formData\r\n    })\r\n    .then((response)=>\r\n        {\r\n            console.log(\"SUCESS\",response);\r\n            return response.json();\r\n        })\r\n    .catch(err=>console.log(err))\r\n};\r\n\r\n\r\n\r\nexport const authenticate = (data,next)=>\r\n{\r\n    if(typeof window!==undefined)\r\n    {\r\n        localStorage.setItem(\"jwt\",JSON.stringify(data));\r\n        next();\r\n    }\r\n};\r\n\r\n\r\nexport const iisAuthenticated = () =>\r\n{\r\n    if (typeof window==undefined)\r\n    {\r\n        return false\r\n    }\r\n    if (localStorage.getItem(\"jwt\"))\r\n    {\r\n        return JSON.parse(localStorage.getItem(\"jwt\"))\r\n    }\r\n    else{\r\n        return false;\r\n    }\r\n\r\n};\r\n\r\nexport const signout = next =>\r\n{\r\n    const userId=iisAuthenticated() && iisAuthenticated().user.userId\r\n    if(typeof window!==undefined)\r\n    {\r\n        localStorage.removeItem(\"jwt\")\r\n        cartEmpty(()=>{\r\n            \r\n        });\r\n        //next();\r\n\r\n        return fetch(`${API}user/logout/${userId}`,\r\n        {\r\n            method:\"GET\"\r\n        })\r\n        .then(response=>{console.log(\"signout success\")\r\n        next();})\r\n        .catch(err=>console.log(err));\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"AAAA,SAAQA,GAAG,QAAO,eAAe;AACjC,SAASC,SAAS,QAAQ,8BAA8B;AACxD;;AAGA,OAAO,IAAMC,MAAM,GAAG,SAATA,MAAM,CAAIC,IAAI,EAC3B;EACI,OAAOC,KAAK,WAAIJ,GAAG,YAAQ;IACvBK,MAAM,EAAC,MAAM;IACbC,OAAO,EAAC;MACJC,MAAM,EAAE,kBAAkB;MAC1B,cAAc,EAAC;IACnB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,IAAI;EAC7B,CAAC,CAAC,CACDQ,IAAI,CAAC,UAAAC,QAAQ,EAAE;IACZ,OAAOA,QAAQ,CAACC,IAAI,EAAE;EAC1B,CAAC,CAAC,CACDC,KAAK,CAAC,UAAAC,GAAG;IAAA,OAAEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;EAAA,EAAC;AACjC,CAAC;AAED,OAAO,IAAMG,MAAM,GAAG,SAATA,MAAM,CAAIf,IAAI,EAC3B;EACI,IAAMgB,QAAQ,GAAG,IAAIC,QAAQ,EAAE;EAE/B,KAAK,IAAMC,IAAI,IAAIlB,IAAI,EACvB;IACIgB,QAAQ,CAACG,MAAM,CAACD,IAAI,EAAClB,IAAI,CAACkB,IAAI,CAAC,CAAC;EACpC;EAEA,OAAOjB,KAAK,WAAIJ,GAAG,kBAAc;IAC7BK,MAAM,EAAC,MAAM;IACbG,IAAI,EAACW;EACT,CAAC,CAAC,CACDR,IAAI,CAAC,UAACC,QAAQ,EACX;IACII,OAAO,CAACC,GAAG,CAAC,QAAQ,EAACL,QAAQ,CAAC;IAC9B,OAAOA,QAAQ,CAACC,IAAI,EAAE;EAC1B,CAAC,CAAC,CACLC,KAAK,CAAC,UAAAC,GAAG;IAAA,OAAEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;EAAA,EAAC;AACjC,CAAC;AAID,OAAO,IAAMQ,YAAY,GAAG,SAAfA,YAAY,CAAIC,IAAI,EAACC,IAAI,EACtC;EACI,IAAG,OAAOC,MAAM,KAAGC,SAAS,EAC5B;IACIC,YAAY,CAACC,OAAO,CAAC,KAAK,EAACpB,IAAI,CAACC,SAAS,CAACc,IAAI,CAAC,CAAC;IAChDC,IAAI,EAAE;EACV;AACJ,CAAC;AAGD,OAAO,IAAMK,gBAAgB,GAAG,SAAnBA,gBAAgB,GAC7B;EACI,IAAI,OAAOJ,MAAM,IAAEC,SAAS,EAC5B;IACI,OAAO,KAAK;EAChB;EACA,IAAIC,YAAY,CAACG,OAAO,CAAC,KAAK,CAAC,EAC/B;IACI,OAAOtB,IAAI,CAACuB,KAAK,CAACJ,YAAY,CAACG,OAAO,CAAC,KAAK,CAAC,CAAC;EAClD,CAAC,MACG;IACA,OAAO,KAAK;EAChB;AAEJ,CAAC;AAED,OAAO,IAAME,OAAO,GAAG,SAAVA,OAAO,CAAGR,IAAI,EAC3B;EACI,IAAMS,MAAM,GAACJ,gBAAgB,EAAE,IAAIA,gBAAgB,EAAE,CAAC3B,IAAI,CAAC+B,MAAM;EACjE,IAAG,OAAOR,MAAM,KAAGC,SAAS,EAC5B;IACIC,YAAY,CAACO,UAAU,CAAC,KAAK,CAAC;IAC9BlC,SAAS,CAAC,YAAI,CAEd,CAAC,CAAC;IACF;;IAEA,OAAOG,KAAK,WAAIJ,GAAG,yBAAekC,MAAM,GACxC;MACI7B,MAAM,EAAC;IACX,CAAC,CAAC,CACDM,IAAI,CAAC,UAAAC,QAAQ,EAAE;MAACI,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;MAC/CQ,IAAI,EAAE;IAAC,CAAC,CAAC,CACRX,KAAK,CAAC,UAAAC,GAAG;MAAA,OAAEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;IAAA,EAAC;EACjC;AACJ,CAAC"},"metadata":{},"sourceType":"module"}